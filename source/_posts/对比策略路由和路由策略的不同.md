---
title: 对比路由策略和策略路由的不同
date: 2025-10-19 19:15:39
tags:
---

简单来说，核心区别在于：

*   **路由策略**：控制**路由信息**的流动路径，影响的是**路由表**。它回答的问题是：“哪些路由信息可以被学习、发布或接收？”
*   **策略路由**：控制**数据包**的转发路径，影响的是**数据包的转发行为**。它回答的问题是：“对于特定的数据包，我应该走哪条路径，而不是根据路由表？”

下面我们通过一个详细的对比表格和解释来深入理解它们的差异。

---

### **策略路由 vs. 路由策略 详细对比**

| 对比维度     | **策略路由**                                                 | **路由策略**                                                 |
| :----------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **核心本质** | **“路”不由“表”定**                                           | **“表”由“策”定**                                             |
| **英文术语** | Policy-Based Routing                                         | Route Policy / Routing Policy                                |
| **操作对象** | **数据包**                                                   | **路由信息**                                                 |
| **工作层次** | 数据转发层面                                                 | 路由控制层面                                                 |
| **决策依据** | 源IP地址、目的IP地址、协议类型、端口号、报文大小、入接口等**丰富的条件** | 通常基于**目的地址**（以及路由属性如AS-Path、Community、MED等） |
| **优先级**   | **高于** 传统路由表。当PBR生效时，它会**绕过**标准路由表进行转发决策。 | **影响** 传统路由表。它决定了哪些路由能进入路由表，从而间接影响转发。 |
| **主要工具** | **Route-map**（在接口下通过 `ip policy route-map` 调用）     | **Route-map, Filter-list, Prefix-list, AS-Path ACL** 等      |
| **应用场景** | 1. **基于源IP的选路**（如不同网段走不同ISP）<br>2. **负载分担**（非基于目的地址的）<br>3. **服务质量**（将特定流量引向防火墙、优化器等） | 1. **路由过滤**（只接收或发布特定路由）<br>2. **路由属性修改**（如BGP的Local_Pref, MED, AS_Path）<br>3. **路由引入**（在路由协议间重分布时进行过滤和属性设置） |
| **配置位置** | 通常在**入方向接口**上应用                                   | 通常在**路由协议**的配置中（如 `neighbor` 语句下）或**重分布**点时应用 |
| **资源消耗** | **较高**。因为需要对每个数据包进行复杂的策略匹配。           | **较低**。仅在路由信息更新时进行计算。                       |

---

### **通俗比喻**

为了更好地理解，我们可以用一个**快递分拣系统**来比喻：

*   **路由策略** 就像是**快递公司的总部规则**：
    *   规则决定了哪些地区的包裹信息（路由）可以被接收和发送到各个分拣中心（路由器）。
    *   例如，“我们不接收来自A地区的包裹信息”，或者“所有发往B地区的包裹信息，都标记为高优先级”。
    *   最终，每个分拣中心都形成了一张“我们能派送的区域表”（路由表）。

*   **策略路由** 就像是**某个特定分拣中心的自定义流水线**：
    *   尽管总部的“区域表”上说“发往B地区的包裹都走陆路”，但这个分拣中心额外规定：“**所有从X小区来的**，发往B地区的包裹，全部走**空运**”。
    *   这个规定**凌驾于**总部的“区域表”之上，它不看目的地是否相同，而是看更具体的来源等特征。

---

### **典型配置示例**

假设一个网络场景：路由器有两个出口，一个连接到ISP1 (10.1.1.1)，另一个连接到ISP2 (20.1.1.1)。

#### **1. 路由策略场景**

**目标**：在运行BGP时，只从ISP1学习关于 `192.168.0.0/16` 网段的路由。

```bash
! 创建一个前缀列表，定义我们感兴趣的路由
ip prefix-list FROM-ISP1 permit 192.168.0.0/16

! 创建一个Route-map来调用这个前缀列表
route-map ROUTE-POLICY permit 10
 match ip address prefix-list FROM-ISP1

! 在BGP进程中，对来自ISP1邻居的路由应用这个策略
router bgp 100
 neighbor 10.1.1.1 route-map ROUTE-POLICY in
```
**效果**：只有 `192.168.0.0/16` 这条路由会被放入路由表，其他从ISP1发来的路由将被过滤掉。

#### **2. 策略路由场景**

**目标**：将所有来自 `172.16.1.0/24` 网段的流量，强制发送到ISP2，即使路由表指出最佳路径是ISP1。

```bash
! 创建一个ACL来匹配感兴趣的流量（基于源IP）
access-list 100 permit ip 172.16.1.0 0.0.0.255 any

! 创建一个Route-map来定义动作
route-map PBR permit 10
 match ip address 100
 set ip next-hop 20.1.1.1  ! 强制设置下一跳为ISP2

! 在接收到流量的入口接口上应用PBR
interface GigabitEthernet0/0
 ip policy route-map PBR
```
**效果**：当数据包从 `GigabitEthernet0/0` 进入，且源IP是 `172.16.1.0/24` 时，路由器会忽略自己的路由表，直接将其转发给 `20.1.1.1` (ISP2)。

### **总结**

| 特性         | 策略路由         | 路由策略             |
| :----------- | :--------------- | :------------------- |
| **核心**     | 控制数据包路径   | 控制路由信息         |
| **对象**     | 数据包           | 路由                 |
| **优先级**   | 高（覆盖路由表） | 低（生成路由表）     |
| **资源消耗** | 高               | 低                   |
| **适用场景** | 精细化的流量工程 | 路由协议的管理和优化 |

简单来说，**路由策略是“管理地图”，而策略路由是“指挥司机”**。前者决定了你手里地图上画了哪些路，后者则是在实际开车时，命令司机无视地图，直接开向某条特定的路。
