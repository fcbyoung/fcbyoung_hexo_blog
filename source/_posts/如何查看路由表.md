---
title: 如何查看路由表
date: 2025-11-01 22:54:16
tags: [网络工程师,计算机网络]
---

在路由器终端输入 `display ip routing-table`（或其简写 `dis ip rou`）后，你会看到路由器返回的路由表信息。理解这些信息的含义至关重要。

下面我将详细解释如何查看和解读这些信息。

### 一个典型的路由表显示示例

在分析之前，我们先看一个典型的输出：

```
<Router> display ip routing-table
Route Flags: R - relay, D - download to fib
------------------------------------------------------------------------------
Routing Tables: Public
         Destinations : 7        Routes : 7

Destination/Mask    Proto   Pre  Cost       Flags NextHop         Interface

        0.0.0.0/0   Static  60   0             D  192.168.1.1      GigabitEthernet0/0/1
      10.0.1.0/24   Direct  0    0             D  10.0.1.1         GigabitEthernet0/0/0
      10.0.1.1/32   Direct  0    0             D  127.0.0.1        InLoopBack0
    10.0.1.255/32   Direct  0    0             D  127.0.0.1        InLoopBack0
     192.168.1.0/24 Direct  0    0             D  192.168.1.254    GigabitEthernet0/0/1
   192.168.1.254/32 Direct  0    0             D  127.0.0.1        InLoopBack0
 192.168.1.255/32   Direct  0    0             D  127.0.0.1        InLoopBack0
```

---

### 逐列解读路由表信息

路由表可以看作一个“路径指示牌”，它告诉路由器：**要去往某个目的地，应该从哪个接口、把数据包扔给下一个谁**。

我们来逐一解读每一列的含义：

#### 1. **Destination/Mask（目的网络/掩码）**
*   **含义**： 这一行路由条目所指向的目标网络地址和子网掩码。
*   **解读**：
    *   `0.0.0.0/0` 是**默认路由**，代表“所有未在路由表中明确指定的目标地址”。可以理解为“万能通道”，当没有更精确的路径时，就走这条路。
    *   `10.0.1.0/24` 代表一个具体的网段，即从 `10.0.1.1` 到 `10.0.1.254` 的所有IP地址。
    *   `10.0.1.1/32` 代表一个**主机路由**，即一个具体的IP地址（`/32` 表示掩码为255.255.255.255，精确匹配一个主机）。

#### 2. **Proto（协议）**
*   **含义**： 这条路由是通过什么方式学习到的。
*   **常见类型**：
    *   **Direct**： 直连路由。路由器直接连接的网络，只要接口配置了IP地址并处于UP状态，就会自动生成。
    *   **Static**： 静态路由。由网络管理员手动配置。
    *   **RIP**、**OSPF**、**IS-IS**、**BGP**： 动态路由协议。路由器之间通过协议算法自动学习到的路由。

#### 3. **Pre（优先级）**
*   **含义**： 路由的“可信度”或“优先级”。数值越小，优先级越高。
*   **解读**： 当去往同一个目的网络存在多条不同来源的路由时（例如，一条静态，一条OSPF），路由器会**优先选择Pre值最小的**路由放入路由表。
    *   直连路由（Direct）的优先级最高，通常是 `0`。
    *   静态路由（Static）的优先级通常是 `60`。
    *   OSPF 内部路由的优先级通常是 `10`。
    *   RIP 的优先级通常是 `100`。

#### 4. **Cost（度量值）**
*   **含义**： 到达目的网络的“开销”或“距离”。
*   **解读**： 当去往同一个目的网络存在**多条相同Proto和Pre**的路由时（例如，都通过OSPF学到），路由器会**优先选择Cost值最小的**路径。
    *   对于直连路由，Cost为 `0`。
    *   对于静态路由，通常可以手动设置，默认为 `0`。
    *   对于动态路由协议，计算方式不同（如RIP是跳数，OSPF是带宽成本）。

#### 5. **Flags（标志）**
*   **含义**： 路由条目的状态标志。
*   **常见标志**：
    *   **D**： 表示这条路由已经**下载到转发信息库（FIB）** 中，可以被直接用于转发数据包。这是你最常见到的标志。
    *   **R**： 表示该路由是迭代路由，需要依赖其他路由才能生效。

#### 6. **NextHop（下一跳）**
*   **含义**： 数据包要发送到的**下一个路由器的接口IP地址**。
*   **解读**：
    *   对于直连网络（Direct），下一跳就是该接口自己的IP（如 `10.0.1.1`）。
    *   对于非直连网络，下一跳是相邻路由器的IP地址（如默认路由的 `192.168.1.1`）。
    *   `127.0.0.1` 表示本地环回地址，通常用于指向路由器自身的主机路由。

#### 7. **Interface（出接口）**
*   **含义**： 路由器将要从哪个物理或逻辑接口把数据包发送出去。
*   **解读**： 这是数据包离开路由器的“门”。例如 `GigabitEthernet0/0/0`、`GigabitEthernet0/0/1`。

---

### 如何分析路由表：一个实际场景

假设你的电脑（IP：`10.0.1.100`）要访问百度（假设IP：`180.101.49.12`）。

1.  路由器收到目标为 `180.101.49.12` 的数据包。
2.  它在路由表中进行**最长匹配**查找：
    *   它会从上到下扫描 `Destination/Mask` 列，寻找与 `180.101.49.12` 最匹配（即掩码最长）的条目。
    *   它找不到 `180.101.49.0/24` 这样的精确条目。
    *   它最终会匹配到 `0.0.0.0/0`（默认路由）。
3.  查看这条默认路由：
    *   `Proto： Static`（管理员配的）
    *   `NextHop: 192.168.1.1`（告诉路由器，把这个包发给 `192.168.1.1` 这个设备）
    *   `Interface: GigabitEthernet0/0/1`（从 `GE0/0/1` 这个接口发出去）
4.  路由器于是将数据包从 `GigabitEthernet0/0/1` 接口转发给 `192.168.1.1`。

### 常用查看技巧和过滤命令

为了更高效地查看路由信息，你可以使用以下过滤命令：

1.  **查看去往特定目标的路由**：
    ```bash
    display ip routing-table <ip-address>
    # 例如：查看去往 10.0.1.50 的路由
    <Router> display ip routing-table 10.0.1.50
    ```

2.  **查看来自特定协议的路由**：
    ```bash
    display ip routing-table protocol <protocol>
    # 例如：只查看所有的静态路由
    <Router> display ip routing-table protocol static
    # 例如：只查看所有OSPF路由
    <Router> display ip routing-table protocol ospf
    ```

3.  **查看更详细的路由信息**（如路由的生存时间等）：
    ```bash
    display ip routing-table verbose
    ```

### 总结

查看 `display ip routing-table` 的结果，核心就是理解这七个字段的含义。通过分析这些信息，你可以：

*   **诊断网络连通性问题**： 数据包是否按照你预期的路径转发？
*   **验证配置是否正确**： 静态路由或动态路由协议是否生效？
*   **了解网络拓扑结构**： 路由器是如何学习到各个网络的路由的？

熟练掌握路由表的解读，是网络管理和故障排查的一项基本功。
